<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>My GPT Agent</title>
  <style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; max-width: 760px; margin: 40px auto; padding: 0 16px; }
    .wrap { display:flex; flex-direction:column; gap:12px; }
    .chat { min-height: 55vh; border: 1px solid #e5e7eb; background: #fff; border-radius: 16px; padding: 12px; overflow-y:auto; }
    .bubble { max-width: 78%; padding: 10px 14px; border-radius: 16px; white-space: pre-wrap; }
    .user   { align-self:flex-end; background:#0f172a; color:#fff; border-bottom-right-radius:6px; }
    .bot    { align-self:flex-start; background:#f3f4f6; color:#111827; border-bottom-left-radius:6px; }
    textarea { width: 100%; border-radius: 12px; padding: 10px; border: 1px solid #cbd5e1; }
    button { border-radius: 12px; padding: 10px 14px; background:#0f172a; color:#fff; border:none; }
    .row { display:flex; gap:10px; align-items:center; justify-content:space-between; }
    .muted { color:#6b7280; font-size:12px; }
    .brand { display:flex; align-items:center; gap:10px; }
    .logo { width:40px; height:40px; background:#0f172a; color:#fff; display:grid; place-items:center; border-radius:14px; font-weight:700; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brand">
      <div class="logo">G</div>
      <div>
        <h1 style="margin:0;">My GPT Agent</h1>
        <div class="muted">Frontend on GitHub Pages • Backend on Cloudflare Workers</div>
      </div>
    </div>

    <div id="chat" class="chat"></div>

    <div>
      <textarea id="msg" rows="3" placeholder="Ask something… (Shift+Enter = newline)"></textarea>
      <div class="row">
        <span class="muted">Your API key lives on the Worker (server), never in the browser.</span>
        <button id="send">Send</button>
      </div>
    </div>
  </div>

  <script>
    // TODO: replace with your Worker URL, e.g. "https://yourname.workers.dev/api/chat"
    const API = "https://YOUR-WORKER-SUBDOMAIN.workers.dev/api/chat";

    const chat = document.getElementById("chat");
    const msg  = document.getElementById("msg");
    const send = document.getElementById("send");

    function add(role, text) {
      const b = document.createElement("div");
      b.className = "bubble " + (role === "user" ? "user" : "bot");
      b.textContent = text;
      chat.appendChild(b);
      chat.scrollTo({ top: chat.scrollHeight, behavior: "smooth" });
    }

    add("bot", "Hi! I’m your agent. Replace the API constant in index.html with your Worker URL, then ask away.");

    msg.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && !e.shiftKey) { e.preventDefault(); submit(); }
    });
    send.addEventListener("click", submit);

    async function submit() {
      const text = msg.value.trim();
      if (!text) return;
      msg.value = "";
      add("user", text);
      add("bot", "…thinking…");

      try {
        const r = await fetch(API, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text })
        });
        const data = await r.json();
        chat.lastChild.textContent = data.reply || data.error || "No reply";
      } catch (e) {
        chat.lastChild.textContent = "Network error: " + e.message;
      }
    }
  </script>
</body>
</html>
